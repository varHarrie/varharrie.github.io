var ye=Object.defineProperty;var we=(n,a,o)=>a in n?ye(n,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[a]=o;var P=(n,a,o)=>(we(n,typeof a!="symbol"?a+"":a,o),o),mt=(n,a,o)=>{if(!a.has(n))throw TypeError("Cannot "+o)};var Z=(n,a,o)=>(mt(n,a,"read from private field"),o?o.call(n):a.get(n)),yt=(n,a,o)=>{if(a.has(n))throw TypeError("Cannot add the same private member more than once");a instanceof WeakSet?a.add(n):a.set(n,o)},Rt=(n,a,o,u)=>(mt(n,a,"write to private field"),u?u.call(n,o):a.set(n,o),o);var it=(n,a,o)=>(mt(n,a,"access private method"),o);import{_ as ve,a as z,b as $,c as ot,d as et,n as _t,l as ge}from"./index-984d0a4c.js";import{S as _e}from"./base-3665f77c-01b57665.js";var lt={},ft={};ft.byteLength=be;ft.toByteArray=Be;ft.fromByteArray=Fe;var D=[],U=[],Ee=typeof Uint8Array<"u"?Uint8Array:Array,wt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Y=0,xe=wt.length;Y<xe;++Y)D[Y]=wt[Y],U[wt.charCodeAt(Y)]=Y;U["-".charCodeAt(0)]=62;U["_".charCodeAt(0)]=63;function Wt(n){var a=n.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var o=n.indexOf("=");o===-1&&(o=a);var u=o===a?0:4-o%4;return[o,u]}function be(n){var a=Wt(n),o=a[0],u=a[1];return(o+u)*3/4-u}function Ie(n,a,o){return(a+o)*3/4-o}function Be(n){var a,o=Wt(n),u=o[0],f=o[1],l=new Ee(Ie(n,u,f)),h=0,s=f>0?u-4:u,m;for(m=0;m<s;m+=4)a=U[n.charCodeAt(m)]<<18|U[n.charCodeAt(m+1)]<<12|U[n.charCodeAt(m+2)]<<6|U[n.charCodeAt(m+3)],l[h++]=a>>16&255,l[h++]=a>>8&255,l[h++]=a&255;return f===2&&(a=U[n.charCodeAt(m)]<<2|U[n.charCodeAt(m+1)]>>4,l[h++]=a&255),f===1&&(a=U[n.charCodeAt(m)]<<10|U[n.charCodeAt(m+1)]<<4|U[n.charCodeAt(m+2)]>>2,l[h++]=a>>8&255,l[h++]=a&255),l}function Se(n){return D[n>>18&63]+D[n>>12&63]+D[n>>6&63]+D[n&63]}function Ae(n,a,o){for(var u,f=[],l=a;l<o;l+=3)u=(n[l]<<16&16711680)+(n[l+1]<<8&65280)+(n[l+2]&255),f.push(Se(u));return f.join("")}function Fe(n){for(var a,o=n.length,u=o%3,f=[],l=16383,h=0,s=o-u;h<s;h+=l)f.push(Ae(n,h,h+l>s?s:h+l));return u===1?(a=n[o-1],f.push(D[a>>2]+D[a<<4&63]+"==")):u===2&&(a=(n[o-2]<<8)+n[o-1],f.push(D[a>>10]+D[a>>4&63]+D[a<<2&63]+"=")),f.join("")}var Et={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Et.read=function(n,a,o,u,f){var l,h,s=f*8-u-1,m=(1<<s)-1,w=m>>1,g=-7,y=o?f-1:0,E=o?-1:1,_=n[a+y];for(y+=E,l=_&(1<<-g)-1,_>>=-g,g+=s;g>0;l=l*256+n[a+y],y+=E,g-=8);for(h=l&(1<<-g)-1,l>>=-g,g+=u;g>0;h=h*256+n[a+y],y+=E,g-=8);if(l===0)l=1-w;else{if(l===m)return h?NaN:(_?-1:1)*(1/0);h=h+Math.pow(2,u),l=l-w}return(_?-1:1)*h*Math.pow(2,l-u)};Et.write=function(n,a,o,u,f,l){var h,s,m,w=l*8-f-1,g=(1<<w)-1,y=g>>1,E=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,_=u?0:l-1,b=u?1:-1,v=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(s=isNaN(a)?1:0,h=g):(h=Math.floor(Math.log(a)/Math.LN2),a*(m=Math.pow(2,-h))<1&&(h--,m*=2),h+y>=1?a+=E/m:a+=E*Math.pow(2,1-y),a*m>=2&&(h++,m/=2),h+y>=g?(s=0,h=g):h+y>=1?(s=(a*m-1)*Math.pow(2,f),h=h+y):(s=a*Math.pow(2,y-1)*Math.pow(2,f),h=0));f>=8;n[o+_]=s&255,_+=b,s/=256,f-=8);for(h=h<<f|s,w+=f;w>0;n[o+_]=h&255,_+=b,h/=256,w-=8);n[o+_-b]|=v*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){const a=ft,o=Et,u=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=s,n.SlowBuffer=N,n.INSPECT_MAX_BYTES=50;const f=2147483647;n.kMaxLength=f,s.TYPED_ARRAY_SUPPORT=l(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const r=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(r,t),r.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function h(r){if(r>f)throw new RangeError('The value "'+r+'" is invalid for option "size"');const t=new Uint8Array(r);return Object.setPrototypeOf(t,s.prototype),t}function s(r,t,e){if(typeof r=="number"){if(typeof t=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(r)}return m(r,t,e)}s.poolSize=8192;function m(r,t,e){if(typeof r=="string")return E(r,t);if(ArrayBuffer.isView(r))return b(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(R(r,ArrayBuffer)||r&&R(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(R(r,SharedArrayBuffer)||r&&R(r.buffer,SharedArrayBuffer)))return v(r,t,e);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return s.from(i,t,e);const c=I(r);if(c)return c;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return s.from(r[Symbol.toPrimitive]("string"),t,e);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}s.from=function(r,t,e){return m(r,t,e)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function w(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function g(r,t,e){return w(r),r<=0?h(r):t!==void 0?typeof e=="string"?h(r).fill(t,e):h(r).fill(t):h(r)}s.alloc=function(r,t,e){return g(r,t,e)};function y(r){return w(r),h(r<0?0:B(r)|0)}s.allocUnsafe=function(r){return y(r)},s.allocUnsafeSlow=function(r){return y(r)};function E(r,t){if((typeof t!="string"||t==="")&&(t="utf8"),!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const e=Bt(r,t)|0;let i=h(e);const c=i.write(r,t);return c!==e&&(i=i.slice(0,c)),i}function _(r){const t=r.length<0?0:B(r.length)|0,e=h(t);for(let i=0;i<t;i+=1)e[i]=r[i]&255;return e}function b(r){if(R(r,Uint8Array)){const t=new Uint8Array(r);return v(t.buffer,t.byteOffset,t.byteLength)}return _(r)}function v(r,t,e){if(t<0||r.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<t+(e||0))throw new RangeError('"length" is outside of buffer bounds');let i;return t===void 0&&e===void 0?i=new Uint8Array(r):e===void 0?i=new Uint8Array(r,t):i=new Uint8Array(r,t,e),Object.setPrototypeOf(i,s.prototype),i}function I(r){if(s.isBuffer(r)){const t=B(r.length)|0,e=h(t);return e.length===0||r.copy(e,0,0,t),e}if(r.length!==void 0)return typeof r.length!="number"||pt(r.length)?h(0):_(r);if(r.type==="Buffer"&&Array.isArray(r.data))return _(r.data)}function B(r){if(r>=f)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f.toString(16)+" bytes");return r|0}function N(r){return+r!=r&&(r=0),s.alloc(+r)}s.isBuffer=function(t){return t!=null&&t._isBuffer===!0&&t!==s.prototype},s.compare=function(t,e){if(R(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),R(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let i=t.length,c=e.length;for(let d=0,p=Math.min(i,c);d<p;++d)if(t[d]!==e[d]){i=t[d],c=e[d];break}return i<c?-1:c<i?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(t.length===0)return s.alloc(0);let i;if(e===void 0)for(e=0,i=0;i<t.length;++i)e+=t[i].length;const c=s.allocUnsafe(e);let d=0;for(i=0;i<t.length;++i){let p=t[i];if(R(p,Uint8Array))d+p.length>c.length?(s.isBuffer(p)||(p=s.from(p)),p.copy(c,d)):Uint8Array.prototype.set.call(c,p,d);else if(s.isBuffer(p))p.copy(c,d);else throw new TypeError('"list" argument must be an Array of Buffers');d+=p.length}return c};function Bt(r,t){if(s.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||R(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);const e=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&e===0)return 0;let c=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return e;case"utf8":case"utf-8":return dt(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return e*2;case"hex":return e>>>1;case"base64":return jt(r).length;default:if(c)return i?-1:dt(r).length;t=(""+t).toLowerCase(),c=!0}}s.byteLength=Bt;function Zt(r,t,e){let i=!1;if((t===void 0||t<0)&&(t=0),t>this.length||((e===void 0||e>this.length)&&(e=this.length),e<=0)||(e>>>=0,t>>>=0,e<=t))return"";for(r||(r="utf8");;)switch(r){case"hex":return se(this,t,e);case"utf8":case"utf-8":return Ft(this,t,e);case"ascii":return oe(this,t,e);case"latin1":case"binary":return ae(this,t,e);case"base64":return ne(this,t,e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ue(this,t,e);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}s.prototype._isBuffer=!0;function q(r,t,e){const i=r[t];r[t]=r[e],r[e]=i}s.prototype.swap16=function(){const t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)q(this,e,e+1);return this},s.prototype.swap32=function(){const t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)q(this,e,e+3),q(this,e+1,e+2);return this},s.prototype.swap64=function(){const t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)q(this,e,e+7),q(this,e+1,e+6),q(this,e+2,e+5),q(this,e+3,e+4);return this},s.prototype.toString=function(){const t=this.length;return t===0?"":arguments.length===0?Ft(this,0,t):Zt.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:s.compare(this,t)===0},s.prototype.inspect=function(){let t="";const e=n.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},u&&(s.prototype[u]=s.prototype.inspect),s.prototype.compare=function(t,e,i,c,d){if(R(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(e===void 0&&(e=0),i===void 0&&(i=t?t.length:0),c===void 0&&(c=0),d===void 0&&(d=this.length),e<0||i>t.length||c<0||d>this.length)throw new RangeError("out of range index");if(c>=d&&e>=i)return 0;if(c>=d)return-1;if(e>=i)return 1;if(e>>>=0,i>>>=0,c>>>=0,d>>>=0,this===t)return 0;let p=d-c,x=i-e;const F=Math.min(p,x),A=this.slice(c,d),M=t.slice(e,i);for(let S=0;S<F;++S)if(A[S]!==M[S]){p=A[S],x=M[S];break}return p<x?-1:x<p?1:0};function St(r,t,e,i,c){if(r.length===0)return-1;if(typeof e=="string"?(i=e,e=0):e>2147483647?e=2147483647:e<-2147483648&&(e=-2147483648),e=+e,pt(e)&&(e=c?0:r.length-1),e<0&&(e=r.length+e),e>=r.length){if(c)return-1;e=r.length-1}else if(e<0)if(c)e=0;else return-1;if(typeof t=="string"&&(t=s.from(t,i)),s.isBuffer(t))return t.length===0?-1:At(r,t,e,i,c);if(typeof t=="number")return t=t&255,typeof Uint8Array.prototype.indexOf=="function"?c?Uint8Array.prototype.indexOf.call(r,t,e):Uint8Array.prototype.lastIndexOf.call(r,t,e):At(r,[t],e,i,c);throw new TypeError("val must be string, number or Buffer")}function At(r,t,e,i,c){let d=1,p=r.length,x=t.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||t.length<2)return-1;d=2,p/=2,x/=2,e/=2}function F(M,S){return d===1?M[S]:M.readUInt16BE(S*d)}let A;if(c){let M=-1;for(A=e;A<p;A++)if(F(r,A)===F(t,M===-1?0:A-M)){if(M===-1&&(M=A),A-M+1===x)return M*d}else M!==-1&&(A-=A-M),M=-1}else for(e+x>p&&(e=p-x),A=e;A>=0;A--){let M=!0;for(let S=0;S<x;S++)if(F(r,A+S)!==F(t,S)){M=!1;break}if(M)return A}return-1}s.prototype.includes=function(t,e,i){return this.indexOf(t,e,i)!==-1},s.prototype.indexOf=function(t,e,i){return St(this,t,e,i,!0)},s.prototype.lastIndexOf=function(t,e,i){return St(this,t,e,i,!1)};function Kt(r,t,e,i){e=Number(e)||0;const c=r.length-e;i?(i=Number(i),i>c&&(i=c)):i=c;const d=t.length;i>d/2&&(i=d/2);let p;for(p=0;p<i;++p){const x=parseInt(t.substr(p*2,2),16);if(pt(x))return p;r[e+p]=x}return p}function Qt(r,t,e,i){return nt(dt(t,r.length-e),r,e,i)}function te(r,t,e,i){return nt(he(t),r,e,i)}function ee(r,t,e,i){return nt(jt(t),r,e,i)}function re(r,t,e,i){return nt(de(t,r.length-e),r,e,i)}s.prototype.write=function(t,e,i,c){if(e===void 0)c="utf8",i=this.length,e=0;else if(i===void 0&&typeof e=="string")c=e,i=this.length,e=0;else if(isFinite(e))e=e>>>0,isFinite(i)?(i=i>>>0,c===void 0&&(c="utf8")):(c=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const d=this.length-e;if((i===void 0||i>d)&&(i=d),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");c||(c="utf8");let p=!1;for(;;)switch(c){case"hex":return Kt(this,t,e,i);case"utf8":case"utf-8":return Qt(this,t,e,i);case"ascii":case"latin1":case"binary":return te(this,t,e,i);case"base64":return ee(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,t,e,i);default:if(p)throw new TypeError("Unknown encoding: "+c);c=(""+c).toLowerCase(),p=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ne(r,t,e){return t===0&&e===r.length?a.fromByteArray(r):a.fromByteArray(r.slice(t,e))}function Ft(r,t,e){e=Math.min(r.length,e);const i=[];let c=t;for(;c<e;){const d=r[c];let p=null,x=d>239?4:d>223?3:d>191?2:1;if(c+x<=e){let F,A,M,S;switch(x){case 1:d<128&&(p=d);break;case 2:F=r[c+1],(F&192)===128&&(S=(d&31)<<6|F&63,S>127&&(p=S));break;case 3:F=r[c+1],A=r[c+2],(F&192)===128&&(A&192)===128&&(S=(d&15)<<12|(F&63)<<6|A&63,S>2047&&(S<55296||S>57343)&&(p=S));break;case 4:F=r[c+1],A=r[c+2],M=r[c+3],(F&192)===128&&(A&192)===128&&(M&192)===128&&(S=(d&15)<<18|(F&63)<<12|(A&63)<<6|M&63,S>65535&&S<1114112&&(p=S))}}p===null?(p=65533,x=1):p>65535&&(p-=65536,i.push(p>>>10&1023|55296),p=56320|p&1023),i.push(p),c+=x}return ie(i)}const Mt=4096;function ie(r){const t=r.length;if(t<=Mt)return String.fromCharCode.apply(String,r);let e="",i=0;for(;i<t;)e+=String.fromCharCode.apply(String,r.slice(i,i+=Mt));return e}function oe(r,t,e){let i="";e=Math.min(r.length,e);for(let c=t;c<e;++c)i+=String.fromCharCode(r[c]&127);return i}function ae(r,t,e){let i="";e=Math.min(r.length,e);for(let c=t;c<e;++c)i+=String.fromCharCode(r[c]);return i}function se(r,t,e){const i=r.length;(!t||t<0)&&(t=0),(!e||e<0||e>i)&&(e=i);let c="";for(let d=t;d<e;++d)c+=pe[r[d]];return c}function ue(r,t,e){const i=r.slice(t,e);let c="";for(let d=0;d<i.length-1;d+=2)c+=String.fromCharCode(i[d]+i[d+1]*256);return c}s.prototype.slice=function(t,e){const i=this.length;t=~~t,e=e===void 0?i:~~e,t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),e<t&&(e=t);const c=this.subarray(t,e);return Object.setPrototypeOf(c,s.prototype),c};function T(r,t,e){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+t>e)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(t,e,i){t=t>>>0,e=e>>>0,i||T(t,e,this.length);let c=this[t],d=1,p=0;for(;++p<e&&(d*=256);)c+=this[t+p]*d;return c},s.prototype.readUintBE=s.prototype.readUIntBE=function(t,e,i){t=t>>>0,e=e>>>0,i||T(t,e,this.length);let c=this[t+--e],d=1;for(;e>0&&(d*=256);)c+=this[t+--e]*d;return c},s.prototype.readUint8=s.prototype.readUInt8=function(t,e){return t=t>>>0,e||T(t,1,this.length),this[t]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(t,e){return t=t>>>0,e||T(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(t,e){return t=t>>>0,e||T(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(t,e){return t=t>>>0,e||T(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(t,e){return t=t>>>0,e||T(t,4,this.length),this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readBigUInt64LE=W(function(t){t=t>>>0,J(t,"offset");const e=this[t],i=this[t+7];(e===void 0||i===void 0)&&X(t,this.length-8);const c=e+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24,d=this[++t]+this[++t]*2**8+this[++t]*2**16+i*2**24;return BigInt(c)+(BigInt(d)<<BigInt(32))}),s.prototype.readBigUInt64BE=W(function(t){t=t>>>0,J(t,"offset");const e=this[t],i=this[t+7];(e===void 0||i===void 0)&&X(t,this.length-8);const c=e*2**24+this[++t]*2**16+this[++t]*2**8+this[++t],d=this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+i;return(BigInt(c)<<BigInt(32))+BigInt(d)}),s.prototype.readIntLE=function(t,e,i){t=t>>>0,e=e>>>0,i||T(t,e,this.length);let c=this[t],d=1,p=0;for(;++p<e&&(d*=256);)c+=this[t+p]*d;return d*=128,c>=d&&(c-=Math.pow(2,8*e)),c},s.prototype.readIntBE=function(t,e,i){t=t>>>0,e=e>>>0,i||T(t,e,this.length);let c=e,d=1,p=this[t+--c];for(;c>0&&(d*=256);)p+=this[t+--c]*d;return d*=128,p>=d&&(p-=Math.pow(2,8*e)),p},s.prototype.readInt8=function(t,e){return t=t>>>0,e||T(t,1,this.length),this[t]&128?(255-this[t]+1)*-1:this[t]},s.prototype.readInt16LE=function(t,e){t=t>>>0,e||T(t,2,this.length);const i=this[t]|this[t+1]<<8;return i&32768?i|4294901760:i},s.prototype.readInt16BE=function(t,e){t=t>>>0,e||T(t,2,this.length);const i=this[t+1]|this[t]<<8;return i&32768?i|4294901760:i},s.prototype.readInt32LE=function(t,e){return t=t>>>0,e||T(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t=t>>>0,e||T(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readBigInt64LE=W(function(t){t=t>>>0,J(t,"offset");const e=this[t],i=this[t+7];(e===void 0||i===void 0)&&X(t,this.length-8);const c=this[t+4]+this[t+5]*2**8+this[t+6]*2**16+(i<<24);return(BigInt(c)<<BigInt(32))+BigInt(e+this[++t]*2**8+this[++t]*2**16+this[++t]*2**24)}),s.prototype.readBigInt64BE=W(function(t){t=t>>>0,J(t,"offset");const e=this[t],i=this[t+7];(e===void 0||i===void 0)&&X(t,this.length-8);const c=(e<<24)+this[++t]*2**16+this[++t]*2**8+this[++t];return(BigInt(c)<<BigInt(32))+BigInt(this[++t]*2**24+this[++t]*2**16+this[++t]*2**8+i)}),s.prototype.readFloatLE=function(t,e){return t=t>>>0,e||T(t,4,this.length),o.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t=t>>>0,e||T(t,4,this.length),o.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t=t>>>0,e||T(t,8,this.length),o.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t=t>>>0,e||T(t,8,this.length),o.read(this,t,!1,52,8)};function O(r,t,e,i,c,d){if(!s.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>c||t<d)throw new RangeError('"value" argument is out of bounds');if(e+i>r.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(t,e,i,c){if(t=+t,e=e>>>0,i=i>>>0,!c){const x=Math.pow(2,8*i)-1;O(this,t,e,i,x,0)}let d=1,p=0;for(this[e]=t&255;++p<i&&(d*=256);)this[e+p]=t/d&255;return e+i},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(t,e,i,c){if(t=+t,e=e>>>0,i=i>>>0,!c){const x=Math.pow(2,8*i)-1;O(this,t,e,i,x,0)}let d=i-1,p=1;for(this[e+d]=t&255;--d>=0&&(p*=256);)this[e+d]=t/p&255;return e+i},s.prototype.writeUint8=s.prototype.writeUInt8=function(t,e,i){return t=+t,e=e>>>0,i||O(this,t,e,1,255,0),this[e]=t&255,e+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(t,e,i){return t=+t,e=e>>>0,i||O(this,t,e,2,65535,0),this[e]=t&255,this[e+1]=t>>>8,e+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(t,e,i){return t=+t,e=e>>>0,i||O(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=t&255,e+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(t,e,i){return t=+t,e=e>>>0,i||O(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t&255,e+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(t,e,i){return t=+t,e=e>>>0,i||O(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4};function Pt(r,t,e,i,c){kt(t,i,c,r,e,7);let d=Number(t&BigInt(4294967295));r[e++]=d,d=d>>8,r[e++]=d,d=d>>8,r[e++]=d,d=d>>8,r[e++]=d;let p=Number(t>>BigInt(32)&BigInt(4294967295));return r[e++]=p,p=p>>8,r[e++]=p,p=p>>8,r[e++]=p,p=p>>8,r[e++]=p,e}function Tt(r,t,e,i,c){kt(t,i,c,r,e,7);let d=Number(t&BigInt(4294967295));r[e+7]=d,d=d>>8,r[e+6]=d,d=d>>8,r[e+5]=d,d=d>>8,r[e+4]=d;let p=Number(t>>BigInt(32)&BigInt(4294967295));return r[e+3]=p,p=p>>8,r[e+2]=p,p=p>>8,r[e+1]=p,p=p>>8,r[e]=p,e+8}s.prototype.writeBigUInt64LE=W(function(t,e=0){return Pt(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeBigUInt64BE=W(function(t,e=0){return Tt(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))}),s.prototype.writeIntLE=function(t,e,i,c){if(t=+t,e=e>>>0,!c){const F=Math.pow(2,8*i-1);O(this,t,e,i,F-1,-F)}let d=0,p=1,x=0;for(this[e]=t&255;++d<i&&(p*=256);)t<0&&x===0&&this[e+d-1]!==0&&(x=1),this[e+d]=(t/p>>0)-x&255;return e+i},s.prototype.writeIntBE=function(t,e,i,c){if(t=+t,e=e>>>0,!c){const F=Math.pow(2,8*i-1);O(this,t,e,i,F-1,-F)}let d=i-1,p=1,x=0;for(this[e+d]=t&255;--d>=0&&(p*=256);)t<0&&x===0&&this[e+d+1]!==0&&(x=1),this[e+d]=(t/p>>0)-x&255;return e+i},s.prototype.writeInt8=function(t,e,i){return t=+t,e=e>>>0,i||O(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=t&255,e+1},s.prototype.writeInt16LE=function(t,e,i){return t=+t,e=e>>>0,i||O(this,t,e,2,32767,-32768),this[e]=t&255,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,i){return t=+t,e=e>>>0,i||O(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=t&255,e+2},s.prototype.writeInt32LE=function(t,e,i){return t=+t,e=e>>>0,i||O(this,t,e,4,2147483647,-2147483648),this[e]=t&255,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,i){return t=+t,e=e>>>0,i||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t&255,e+4},s.prototype.writeBigInt64LE=W(function(t,e=0){return Pt(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),s.prototype.writeBigInt64BE=W(function(t,e=0){return Tt(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ot(r,t,e,i,c,d){if(e+i>r.length)throw new RangeError("Index out of range");if(e<0)throw new RangeError("Index out of range")}function Ct(r,t,e,i,c){return t=+t,e=e>>>0,c||Ot(r,t,e,4),o.write(r,t,e,i,23,4),e+4}s.prototype.writeFloatLE=function(t,e,i){return Ct(this,t,e,!0,i)},s.prototype.writeFloatBE=function(t,e,i){return Ct(this,t,e,!1,i)};function Lt(r,t,e,i,c){return t=+t,e=e>>>0,c||Ot(r,t,e,8),o.write(r,t,e,i,52,8),e+8}s.prototype.writeDoubleLE=function(t,e,i){return Lt(this,t,e,!0,i)},s.prototype.writeDoubleBE=function(t,e,i){return Lt(this,t,e,!1,i)},s.prototype.copy=function(t,e,i,c){if(!s.isBuffer(t))throw new TypeError("argument should be a Buffer");if(i||(i=0),!c&&c!==0&&(c=this.length),e>=t.length&&(e=t.length),e||(e=0),c>0&&c<i&&(c=i),c===i||t.length===0||this.length===0)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("sourceEnd out of bounds");c>this.length&&(c=this.length),t.length-e<c-i&&(c=t.length-e+i);const d=c-i;return this===t&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(e,i,c):Uint8Array.prototype.set.call(t,this.subarray(i,c),e),d},s.prototype.fill=function(t,e,i,c){if(typeof t=="string"){if(typeof e=="string"?(c=e,e=0,i=this.length):typeof i=="string"&&(c=i,i=this.length),c!==void 0&&typeof c!="string")throw new TypeError("encoding must be a string");if(typeof c=="string"&&!s.isEncoding(c))throw new TypeError("Unknown encoding: "+c);if(t.length===1){const p=t.charCodeAt(0);(c==="utf8"&&p<128||c==="latin1")&&(t=p)}}else typeof t=="number"?t=t&255:typeof t=="boolean"&&(t=Number(t));if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;e=e>>>0,i=i===void 0?this.length:i>>>0,t||(t=0);let d;if(typeof t=="number")for(d=e;d<i;++d)this[d]=t;else{const p=s.isBuffer(t)?t:s.from(t,c),x=p.length;if(x===0)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(d=0;d<i-e;++d)this[d+e]=p[d%x]}return this};const G={};function ht(r,t,e){G[r]=class extends e{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(c){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:c,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}ht("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ht("ERR_INVALID_ARG_TYPE",function(r,t){return`The "${r}" argument must be of type number. Received type ${typeof t}`},TypeError),ht("ERR_OUT_OF_RANGE",function(r,t,e){let i=`The value of "${r}" is out of range.`,c=e;return Number.isInteger(e)&&Math.abs(e)>2**32?c=Ut(String(e)):typeof e=="bigint"&&(c=String(e),(e>BigInt(2)**BigInt(32)||e<-(BigInt(2)**BigInt(32)))&&(c=Ut(c)),c+="n"),i+=` It must be ${t}. Received ${c}`,i},RangeError);function Ut(r){let t="",e=r.length;const i=r[0]==="-"?1:0;for(;e>=i+4;e-=3)t=`_${r.slice(e-3,e)}${t}`;return`${r.slice(0,e)}${t}`}function ce(r,t,e){J(t,"offset"),(r[t]===void 0||r[t+e]===void 0)&&X(t,r.length-(e+1))}function kt(r,t,e,i,c,d){if(r>e||r<t){const p=typeof t=="bigint"?"n":"";let x;throw d>3?t===0||t===BigInt(0)?x=`>= 0${p} and < 2${p} ** ${(d+1)*8}${p}`:x=`>= -(2${p} ** ${(d+1)*8-1}${p}) and < 2 ** ${(d+1)*8-1}${p}`:x=`>= ${t}${p} and <= ${e}${p}`,new G.ERR_OUT_OF_RANGE("value",x,r)}ce(i,c,d)}function J(r,t){if(typeof r!="number")throw new G.ERR_INVALID_ARG_TYPE(t,"number",r)}function X(r,t,e){throw Math.floor(r)!==r?(J(r,e),new G.ERR_OUT_OF_RANGE(e||"offset","an integer",r)):t<0?new G.ERR_BUFFER_OUT_OF_BOUNDS:new G.ERR_OUT_OF_RANGE(e||"offset",`>= ${e?1:0} and <= ${t}`,r)}const le=/[^+/0-9A-Za-z-_]/g;function fe(r){if(r=r.split("=")[0],r=r.trim().replace(le,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function dt(r,t){t=t||1/0;let e;const i=r.length;let c=null;const d=[];for(let p=0;p<i;++p){if(e=r.charCodeAt(p),e>55295&&e<57344){if(!c){if(e>56319){(t-=3)>-1&&d.push(239,191,189);continue}else if(p+1===i){(t-=3)>-1&&d.push(239,191,189);continue}c=e;continue}if(e<56320){(t-=3)>-1&&d.push(239,191,189),c=e;continue}e=(c-55296<<10|e-56320)+65536}else c&&(t-=3)>-1&&d.push(239,191,189);if(c=null,e<128){if((t-=1)<0)break;d.push(e)}else if(e<2048){if((t-=2)<0)break;d.push(e>>6|192,e&63|128)}else if(e<65536){if((t-=3)<0)break;d.push(e>>12|224,e>>6&63|128,e&63|128)}else if(e<1114112){if((t-=4)<0)break;d.push(e>>18|240,e>>12&63|128,e>>6&63|128,e&63|128)}else throw new Error("Invalid code point")}return d}function he(r){const t=[];for(let e=0;e<r.length;++e)t.push(r.charCodeAt(e)&255);return t}function de(r,t){let e,i,c;const d=[];for(let p=0;p<r.length&&!((t-=2)<0);++p)e=r.charCodeAt(p),i=e>>8,c=e%256,d.push(c),d.push(i);return d}function jt(r){return a.toByteArray(fe(r))}function nt(r,t,e,i){let c;for(c=0;c<i&&!(c+e>=t.length||c>=r.length);++c)t[c+e]=r[c];return c}function R(r,t){return r instanceof t||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===t.name}function pt(r){return r!==r}const pe=function(){const r="0123456789abcdef",t=new Array(256);for(let e=0;e<16;++e){const i=e*16;for(let c=0;c<16;++c)t[i+c]=r[e]+r[c]}return t}();function W(r){return typeof BigInt>"u"?me:r}function me(){throw new Error("BigInt not supported")}})(lt);var Me=Object.create,xt=Object.defineProperty,Pe=Object.getOwnPropertyDescriptor,Vt=Object.getOwnPropertyNames,Te=Object.getPrototypeOf,Oe=Object.prototype.hasOwnProperty,Ce=(n,a,o)=>a in n?xt(n,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[a]=o,C=(n,a)=>function(){return a||(0,n[Vt(n)[0]])((a={exports:{}}).exports,a),a.exports},Le=(n,a,o,u)=>{if(a&&typeof a=="object"||typeof a=="function")for(let f of Vt(a))!Oe.call(n,f)&&f!==o&&xt(n,f,{get:()=>a[f],enumerable:!(u=Pe(a,f))||u.enumerable});return n},j=(n,a,o)=>(o=n!=null?Me(Te(n)):{},Le(a||!n||!n.__esModule?xt(o,"default",{value:n,enumerable:!0}):o,n)),Ue=(n,a,o)=>(Ce(n,typeof a!="symbol"?a+"":a,o),o),bt=(n,a,o)=>{if(!a.has(n))throw TypeError("Cannot "+o)},L=(n,a,o)=>(bt(n,a,"read from private field"),o?o.call(n):a.get(n)),H=(n,a,o)=>{if(a.has(n))throw TypeError("Cannot add the same private member more than once");a instanceof WeakSet?a.add(n):a.set(n,o)},K=(n,a,o,u)=>(bt(n,a,"write to private field"),u?u.call(n,o):a.set(n,o),o),k=(n,a,o)=>(bt(n,a,"access private method"),o),qt=C({"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/pad.js"(n,a){a.exports=function(u,f){var l="000000000"+u;return l.substr(l.length-f)}}}),ke=C({"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/fingerprint.browser.js"(n,a){var o=qt(),u=typeof window=="object"?window:self,f=Object.keys(u).length,l=navigator.mimeTypes?navigator.mimeTypes.length:0,h=o((l+navigator.userAgent.length).toString(36)+f.toString(36),4);a.exports=function(){return h}}}),je=C({"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/lib/getRandomValue.browser.js"(n,a){var o,u=typeof window<"u"&&(window.crypto||window.msCrypto)||typeof self<"u"&&self.crypto;u?(f=Math.pow(2,32)-1,o=function(){return Math.abs(u.getRandomValues(new Uint32Array(1))[0]/f)}):o=Math.random;var f;a.exports=o}}),Ht=C({"../../node_modules/.pnpm/cuid@2.1.8/node_modules/cuid/index.js"(n,a){var o=ke(),u=qt(),f=je(),l=0,h=4,s=36,m=Math.pow(s,h);function w(){return u((f()*m<<0).toString(s),h)}function g(){return l=l<m?l:0,l++,l-1}function y(){var E="c",_=new Date().getTime().toString(s),b=u(g().toString(s),h),v=o(),I=w()+w();return E+_+b+v+I}y.slug=function(){var _=new Date().getTime().toString(36),b=g().toString(36).slice(-4),v=o().slice(0,1)+o().slice(-1),I=w().slice(-2);return _.slice(-2)+b+v+I},y.isCuid=function(_){return typeof _!="string"?!1:!!_.startsWith("c")},y.isSlug=function(_){if(typeof _!="string")return!1;var b=_.length;return b>=7&&b<=10},y.fingerprint=o,a.exports=y}}),Gt=C({"../../node_modules/.pnpm/outvariant@1.3.0/node_modules/outvariant/lib/format.js"(n){Object.defineProperty(n,"__esModule",{value:!0}),n.format=void 0;var a=/(%?)(%([sdjo]))/g;function o(f,l){switch(l){case"s":return f;case"d":case"i":return Number(f);case"j":return JSON.stringify(f);case"o":{if(typeof f=="string")return f;var h=JSON.stringify(f);return h==="{}"||h==="[]"||/^\[object .+?\]$/.test(h)?f:h}}}function u(f){for(var l=[],h=1;h<arguments.length;h++)l[h-1]=arguments[h];if(l.length===0)return f;var s=0,m=f.replace(a,function(w,g,y,E){var _=l[s],b=o(_,E);return g?w:(s++,b)});return s<l.length&&(m+=" "+l.slice(s).join(" ")),m=m.replace(/%{2,2}/g,"%"),m}n.format=u}}),Re=C({"../../node_modules/.pnpm/outvariant@1.3.0/node_modules/outvariant/lib/invariant.js"(n){var a=n&&n.__extends||function(){var w=function(g,y){return w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(E,_){E.__proto__=_}||function(E,_){for(var b in _)Object.prototype.hasOwnProperty.call(_,b)&&(E[b]=_[b])},w(g,y)};return function(g,y){if(typeof y!="function"&&y!==null)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");w(g,y);function E(){this.constructor=g}g.prototype=y===null?Object.create(y):(E.prototype=y.prototype,new E)}}(),o=n&&n.__spreadArray||function(w,g){for(var y=0,E=g.length,_=w.length;y<E;y++,_++)w[_]=g[y];return w};Object.defineProperty(n,"__esModule",{value:!0}),n.invariant=n.createInvariantWith=n.InvariantError=void 0;var u=Gt(),f=2;function l(w){if(w.stack){var g=w.stack.split(`
`);g.splice(1,f),w.stack=g.join(`
`)}}var h=function(w){a(g,w);function g(y){for(var E=[],_=1;_<arguments.length;_++)E[_-1]=arguments[_];var b=w.call(this,y)||this;return b.message=y,b.name="Invariant Violation",b.message=u.format.apply(void 0,o([y],E)),l(b),b}return g}(Error);n.InvariantError=h;function s(w){var g=function(y,E){for(var _=[],b=2;b<arguments.length;b++)_[b-2]=arguments[b];if(!y){var v=u.format.apply(void 0,o([E],_)),I=!!w.prototype.name,B=I?new w(v):w(v);throw l(B),B}};return g}n.createInvariantWith=s;function m(w){for(var g=[],y=1;y<arguments.length;y++)g[y-1]=arguments[y];return s(w).apply(void 0,g)}n.invariant=s(h),n.invariant.as=m}}),rt=C({"../../node_modules/.pnpm/outvariant@1.3.0/node_modules/outvariant/lib/index.js"(n){var a=n&&n.__createBinding||(Object.create?function(u,f,l,h){h===void 0&&(h=l),Object.defineProperty(u,h,{enumerable:!0,get:function(){return f[l]}})}:function(u,f,l,h){h===void 0&&(h=l),u[h]=f[l]}),o=n&&n.__exportStar||function(u,f){for(var l in u)l!=="default"&&!Object.prototype.hasOwnProperty.call(f,l)&&a(f,u,l)};Object.defineProperty(n,"__esModule",{value:!0}),o(Re(),n),o(Gt(),n)}}),Jt=C({"../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/createDeferredExecutor.js"(n){Object.defineProperty(n,"__esModule",{value:!0}),n.createDeferredExecutor=void 0;function a(){const o=(u,f)=>{o.state="pending",o.resolve=l=>{if(o.state!=="pending")return;o.result=l;const h=s=>(o.state="fulfilled",s);return u(l instanceof Promise?l:Promise.resolve(l).then(h))},o.reject=l=>{if(o.state==="pending")return queueMicrotask(()=>{o.state="rejected"}),f(o.rejectionReason=l)}};return o}n.createDeferredExecutor=a}}),De=C({"../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/DeferredPromise.js"(n){var u,f,ut,h;Object.defineProperty(n,"__esModule",{value:!0}),n.DeferredPromise=void 0;var a=Jt(),o=(h=class extends Promise{constructor(m=null){const w=(0,a.createDeferredExecutor)();super((g,y)=>{w(g,y),m==null||m(w.resolve,w.reject)});yt(this,f);yt(this,u,void 0);P(this,"resolve");P(this,"reject");Rt(this,u,w),this.resolve=Z(this,u).resolve,this.reject=Z(this,u).reject}get state(){return Z(this,u).state}get rejectionReason(){return Z(this,u).rejectionReason}then(m,w){return it(this,f,ut).call(this,super.then(m,w))}catch(m){return it(this,f,ut).call(this,super.catch(m))}finally(m){return it(this,f,ut).call(this,super.finally(m))}},u=new WeakMap,f=new WeakSet,ut=function(m){return Object.defineProperties(m,{resolve:{configurable:!0,value:this.resolve},reject:{configurable:!0,value:this.reject}})},h);n.DeferredPromise=o}}),It=C({"../../node_modules/.pnpm/@open-draft+deferred-promise@2.1.0/node_modules/@open-draft/deferred-promise/build/index.js"(n){var a=n&&n.__createBinding||(Object.create?function(u,f,l,h){h===void 0&&(h=l);var s=Object.getOwnPropertyDescriptor(f,l);(!s||("get"in s?!f.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return f[l]}}),Object.defineProperty(u,h,s)}:function(u,f,l,h){h===void 0&&(h=l),u[h]=f[l]}),o=n&&n.__exportStar||function(u,f){for(var l in u)l!=="default"&&!Object.prototype.hasOwnProperty.call(f,l)&&a(f,u,l)};Object.defineProperty(n,"__esModule",{value:!0}),o(Jt(),n),o(De(),n)}}),Yt=C({"../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/MemoryLeakError.js"(n){Object.defineProperty(n,"__esModule",{value:!0}),n.MemoryLeakError=void 0;var a=class extends Error{constructor(u,f,l){super(`Possible EventEmitter memory leak detected. ${l} ${f.toString()} listeners added. Use emitter.setMaxListeners() to increase limit`);P(this,"emitter");P(this,"type");P(this,"count");this.emitter=u,this.type=f,this.count=l,this.name="MaxListenersExceededWarning"}};n.MemoryLeakError=a}}),Ne=C({"../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/Emitter.js"(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Emitter=void 0;var a=Yt(),o,u,f,l,h,s,m,w,g,y,E,_=class{constructor(){H(this,l),H(this,s),H(this,w),H(this,y),H(this,o,void 0),H(this,u,void 0),H(this,f,void 0),K(this,o,new Map),K(this,u,_.defaultMaxListeners),K(this,f,!1)}static listenerCount(v,I){return v.listenerCount(I)}setMaxListeners(v){return K(this,u,v),this}getMaxListeners(){return L(this,u)}eventNames(){return Array.from(L(this,o).keys())}emit(v,...I){const B=k(this,l,h).call(this,v);return B.forEach(N=>{N.apply(this,I)}),B.length>0}addListener(v,I){k(this,y,E).call(this,"newListener",v,I);const B=k(this,l,h).call(this,v).concat(I);if(L(this,o).set(v,B),L(this,u)>0&&this.listenerCount(v)>L(this,u)&&!L(this,f)){K(this,f,!0);const N=new a.MemoryLeakError(this,v,this.listenerCount(v));console.warn(N)}return this}on(v,I){return this.addListener(v,I)}once(v,I){return this.addListener(v,k(this,w,g).call(this,v,I))}prependListener(v,I){const B=k(this,l,h).call(this,v);if(B.length>0){const N=[I].concat(B);L(this,o).set(v,N)}else L(this,o).set(v,B.concat(I));return this}prependOnceListener(v,I){return this.prependListener(v,k(this,w,g).call(this,v,I))}removeListener(v,I){const B=k(this,l,h).call(this,v);return B.length>0&&(k(this,s,m).call(this,B,I),L(this,o).set(v,B),k(this,y,E).call(this,"removeListener",v,I)),this}off(v,I){return this.removeListener(v,I)}removeAllListeners(v){return v?L(this,o).delete(v):L(this,o).clear(),this}listeners(v){return Array.from(k(this,l,h).call(this,v))}listenerCount(v){return k(this,l,h).call(this,v).length}rawListeners(v){return this.listeners(v)}},b=_;o=new WeakMap,u=new WeakMap,f=new WeakMap,l=new WeakSet,h=function(v){return L(this,o).get(v)||[]},s=new WeakSet,m=function(v,I){const B=v.indexOf(I);return B>-1&&v.splice(B,1),[]},w=new WeakSet,g=function(v,I){const B=(...N)=>{this.removeListener(v,B),I.apply(this,N)};return B},y=new WeakSet,E=function(v,I,B){this.emit(v,I,B)},Ue(b,"defaultMaxListeners",10),n.Emitter=b}}),ze=C({"../../node_modules/.pnpm/strict-event-emitter@0.4.3/node_modules/strict-event-emitter/lib/index.js"(n){var a=n&&n.__createBinding||(Object.create?function(u,f,l,h){h===void 0&&(h=l);var s=Object.getOwnPropertyDescriptor(f,l);(!s||("get"in s?!f.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return f[l]}}),Object.defineProperty(u,h,s)}:function(u,f,l,h){h===void 0&&(h=l),u[h]=f[l]}),o=n&&n.__exportStar||function(u,f){for(var l in u)l!=="default"&&!Object.prototype.hasOwnProperty.call(f,l)&&a(f,u,l)};Object.defineProperty(n,"__esModule",{value:!0}),o(Ne(),n),o(Yt(),n)}}),$e=j(Ht());j(rt());var vt=j(It()),We=window.localStorage.CSB_EMULATOR_DEBUG,Ve="\x1B[0m",qe="\x1B[32;1m",He="\x1B[31m",Ge="\x1B[34m",Je="\x1B[33;1m",Ye="\x1B[35;1m",Dt="\x1B[36;1m",Xe={preview:Je,emulator:Ye,runtime:Dt,bridge:Ge,"runtime:worker":Dt};function Xt(n){return function(o,...u){if(We==="true"){const f=()=>o.includes("sender")?`${qe}sender`:o.includes("receiver")?`${He}receiver`:"",l=o.replace(/\[.+\]:/,"");console.log(`${Xe[n]}${n}:${f()}${Ve}:${l}`,...u)}}}var V=Xt("emulator"),Ze=class{constructor(n){P(this,"emitter");P(this,"channel");P(this,"receiverPort");P(this,"receiverReadyPromise");this.target=n,this.emitter=new EventTarget,this.channel=new MessageChannel,this.receiverPort=this.channel.port1;const a=new vt.DeferredPromise,o=u=>{u.data.type==="internal/ready"&&(V("[message-sender]: runtime is ready"),a.resolve())};window.addEventListener("message",o),a.then(()=>{window.removeEventListener("message",o)}),this.receiverReadyPromise=a,this.receiverPort.onmessage=u=>{const f=u.data;f.type!=null&&(V('[message-sender]: emitting "%s" event...',f.type,f.payload),this.emitter.dispatchEvent(new MessageEvent(f.type,{data:f.payload})))}}async handshake(){const n=new vt.DeferredPromise;await this.receiverReadyPromise,V("[message-sender]: sending handshake"),this.target.postMessage({type:"internal/handshake"},"*",[this.channel.port2]),this.on("internal/handshake/done",()=>{n.resolve(),clearTimeout(a)});const a=setTimeout(()=>{n.reject(new Error("MessageSender: Handshake timeout"))},5e3);return n}on(n,a,o){V('[message-sender]: add listener "%s"',n),this.emitter.addEventListener(n,u=>{u instanceof MessageEvent&&a(u)},o)}off(n,a,o){this.emitter.removeEventListener(n,a,o)}async send(n,...a){const o=new vt.DeferredPromise,u=(0,$e.default)(),f=a[0]||{};V('[message-sender]: send "%s" (%s)',n,u,f),this.receiverPort.postMessage({type:n,payload:{operationId:u,payload:f}}),V('[message-sender]: adding done listener for "%s" (%s)',n,u);const l=s=>{const{data:m}=s;if(m.operationId===u){const w=m.listenerPayload||{};V('[message-sender]: resolving "%s (%s) promise!',n,u),o.resolve({...w,operationId:m.operationId})}},h=s=>{const{data:m}=s;m.operationId===u&&(V('[message-sender]: rejecting "%s (%s) promise!',n,u),o.reject(m.error))};return this.on("internal/operation/done",l),this.on("internal/operation/failed",h),o.finally(()=>{this.emitter.removeEventListener("internal/operation/done",l),this.emitter.removeEventListener("internal/operation/failed",h)})}},Q=j(rt()),Nt=j(It()),Ke=j(Ht()),tt=j(rt()),Qe=class{constructor(n){this.channel=n}async init(n){await this.channel.send("fs/init",{files:n})}async readFile(n,a){const o=await this.channel.send("fs/readFile",{path:n,encoding:a}).catch(u=>{throw new Error((0,tt.format)('Failed to read file at path "%s"',n),{cause:u})});if(!o)throw new Error("File not found");return o.data}async writeFile(n,a,o){let u,f=!1;typeof o=="object"?(u=o.encoding,f=!!o.recursive):typeof o=="string"&&(u=o),await this.channel.send("fs/writeFile",{path:n,content:a,encoding:u,recursive:f}).catch(l=>{throw new Error((0,tt.format)('Failed to write file at path "%s"',n),{cause:l})})}async readdir(n){const a=await this.channel.send("fs/readdir",{path:n}).catch(o=>{throw new Error((0,tt.format)('Failed to read directory at path "%s"',n),{cause:o})});if(!a)throw new Error("Directory not found");return a.data}async mkdir(n,a){const o=!!(a!=null&&a.recursive);await this.channel.send("fs/mkdir",{path:n,recursive:o}).catch(u=>{throw new Error((0,tt.format)('Failed to make directory at path "%s"',n),{cause:u})})}async stat(n){const a=await this.channel.send("fs/stat",{path:n}).catch(o=>{throw new Error((0,tt.format)('Failed to stat file at path "%s"',n),{cause:o})});if(!a)throw new Error("File not found");return a.data}async watch(n,a,o){const u=(0,Ke.default)();return await this.channel.send("fs/watch",{watcherId:u,includes:n,excludes:a}),this.channel.on("fs/watch-event",({data:f})=>{if(f.watcherId===u&&o){const l={...f};delete l.watcherId,o(l)}}),{dispose:()=>this.channel.send("fs/unwatch",{watcherId:u})}}},at=j(rt()),zt=j(ze()),tr=class{constructor(n){this.channel=n}create(){return new er(this.channel)}},er=class{constructor(n){P(this,"id");P(this,"state");P(this,"stdout");P(this,"stderr");P(this,"stdin");this.channel=n,this.state="running",this.stdout=new zt.Emitter,this.stderr=new zt.Emitter,this.stdin={write:a=>{if(!this.id)throw new Error("Failed to write to stdin, no process is currently running");return this.channel.send("shell/stdin",{data:a,workerId:this.id})}},this.forwardStdEvents()}forwardStdEvents(){this.channel.on("worker/tty",n=>{const{data:a}=n;if(a.workerId===this.id)switch(a.payload.type){case"out":{this.stdout.emit("data",a.payload.data);break}case"err":{this.stderr.emit("data",a.payload.data);break}}})}async runCommand(n,a,o={}){(0,at.invariant)(!this.id,'Failed to run "runCommand" on a ShellProcess: there is already a process running.');const u=await this.channel.send("shell/runCommand",{command:n,args:a,options:o});return(0,at.invariant)(u,'Failed to run "runCommand" on a ShellProcess: was not able to retrieve a running process.'),this.id=u.id,this.state="running",u}async on(n,a){switch(n){case"progress":{this.channel.on("worker/progress",({data:o})=>{a(o.status)});return}case"exit":{this.channel.on("worker/exit",({data:o})=>{o.workerId===this.id&&a(o.exitCode,o.error)});return}}}async kill(){(0,at.invariant)(this.id,'Failed to run "kill" on a ShellProcess: there is no process running. Did you forget to run it?'),this.state="idle",await this.channel.send("shell/exit",{id:this.id}).catch(n=>{throw new Error((0,at.format)('Failed to kill shell with ID "%s"',this.id),{cause:n})}),this.id=void 0}},gt=j(rt()),rr=j(It()),nr=2e4,ir=class{constructor(n){this.channel=n}async waitFor(n,a,o=nr){const u=new rr.DeferredPromise,f=setTimeout(()=>{u.reject()},o),l=await this.channel.send("preview/get/info",n).catch(s=>{u.reject(new Error((0,gt.format)('Failed to look up preview information for shell ID "%s" (port: %d)',n.sourceShellId,n.port)))}),h=l&&a(l);return h&&u.resolve({url:l.url,port:l.port,sourceShellId:l.sourceShellId}),this.channel.on("preview/port/ready",({data:s})=>{!h&&a(s)&&u.resolve({url:s.url,port:s.port,sourceShellId:s.sourceShellId})}),u.finally(()=>{clearTimeout(f)})}async getByShellId(n,a){return this.waitFor({sourceShellId:n},o=>o.sourceShellId===n,a).catch(o=>{throw new Error((0,gt.format)('Failed to get shell by ID "%s"',n),{cause:o})})}async waitForPort(n,a){return this.waitFor({port:n},o=>o.port===n,a).catch(o=>{throw new Error((0,gt.format)("Failed to await port %d",n),{cause:o})})}},or="https://nodebox-runtime.codesandbox.io",st=Xt("emulator"),ar=class{constructor(n){P(this,"channel",null);P(this,"isConnected");P(this,"url");P(this,"fileSystemApi",null);P(this,"shellApi",null);P(this,"previewApi",null);this.options=n,(0,Q.invariant)(this.options.iframe,'Failed to create a Nodebox: expected "iframe" argument to be a reference to an <iframe> element but got %j',this.options.iframe),this.url=this.options.runtimeUrl||or,this.isConnected=!1}async connect(){const{iframe:n,cdnUrl:a}=this.options;st("[message-sender]: Connecting to node emulator...");const o=new Nt.DeferredPromise;this.url||o.reject(new Error("Nodebox URL is missing. Did you forget to provide it when creating this Nodebox instance?")),(0,Q.invariant)(n.contentWindow,"Failed to create a MessageChannel with the Nodebox iframe: no content window found"),this.channel=new Ze(n.contentWindow);const u=new Nt.DeferredPromise;return n.setAttribute("src",this.url),n.addEventListener("load",()=>{u.resolve()},{once:!0}),n.addEventListener("error",f=>{u.reject(f.error)},{once:!0}),await u,st("[message-sender]: IFrame loaded..."),await this.channel.handshake(),st("[message-sender]: Handshake completed..."),this.channel.send("connect",{cdnUrl:a}),this.channel.on("runtime/ready",()=>{o.resolve()}),o.then(()=>{st("[message-sender]: Connected to runtime..."),this.isConnected=!0})}get fs(){return(0,Q.invariant)(this.isConnected,'Failed to access the File System API: consumer is not connected. Did you forget to run "connect()"?'),this.fileSystemApi?this.fileSystemApi:(this.fileSystemApi=new Qe(this.channel),this.fileSystemApi)}get shell(){return(0,Q.invariant)(this.isConnected,'Failed to access the Shell API: consumer is not connected. Did you forget to run "connect()"?'),this.shellApi?this.shellApi:(this.shellApi=new tr(this.channel),this.shellApi)}get preview(){return(0,Q.invariant)(this.isConnected,'Failed to access the Preview API: consumer is not connected. Did you forget to run "connect()"?'),this.previewApi?this.previewApi:(this.previewApi=new ir(this.channel),this.previewApi)}},sr="INJECT_AND_INVOKE",ur="PREVIEW_LOADED",ct=function(n,a){return a===void 0&&(a="utf8"),typeof n=="string"?lt.Buffer.from(n,a):n},cr=function(n){return typeof n=="string"?n:lt.Buffer.from(n).toString("utf-8")},lr=function(n){return Object.entries(n).reduce(function(a,o){var u=o[0],f=o[1];return a[u]=ct(f.code),a},{})},fr=function(n){var a,o={},u=["dev","start"];try{o=JSON.parse(n).scripts}catch(y){throw et("Could not parse package.json file: "+y.message)}ge.invariant(o,"Failed to start. Please provide a `start` or `dev` script on the package.json");for(var f=0;f<u.length;f++)if(u[f]in o){var l=u[f],h=o[l],s=(a=h.match(/(\w+=\w+;)*\w+=\w+/g))===null||a===void 0?void 0:a.reduce(function(y,E){var _=E.split("="),b=_[0],v=_[1];return y[b]=v,y},{}),m=h.replace(/(\w+=\w+;)*\w+=\w+/g,"").trim().split(" "),w=m[0],g=m.slice(1);return[w,g,{env:s}]}throw et("Failed to start. Please provide a `start` or `dev` script on the package.json")},$t=function(n){return typeof n=="string"?n:typeof n=="object"&&"message"in n?n.message:et("The server could not be reached. Make sure that the node script is running and that a port has been started.")},hr=function(){function n(){this.listeners={},this.listenersCount=0,this.channelId=Math.floor(Math.random()*1e6),this.listeners=[]}return n.prototype.cleanup=function(){this.listeners={},this.listenersCount=0},n.prototype.dispatch=function(a){Object.values(this.listeners).forEach(function(o){return o(a)})},n.prototype.listener=function(a){var o=this;if(typeof a!="function")return function(){};var u=this.listenersCount;return this.listeners[u]=a,this.listenersCount++,function(){delete o.listeners[u]}},n}();function dr(n,a){return z(this,void 0,void 0,function(){var o,u,f,l,h;return $(this,function(s){return o=n.contentWindow,_t(o,"Failed to await preview iframe: no content window found"),u=3e3,f=20,l=0,[2,new Promise(function(m,w){var g=function(){var y=function(){clearTimeout(h),l=f,m(),n.removeEventListener("load",y)};if(l>=f){w(et("Could not able to connect to preview."));return}n.setAttribute("src",a),h=setTimeout(function(){g(),n.removeEventListener("load",y)},u),l=l+1,n.addEventListener("load",y)};n.addEventListener("error",function(){return w(new Error("Iframe error"))}),n.addEventListener("abort",function(){return w(new Error("Aborted"))}),g()})]})})}var pr=function(n,a){n.style.border="0",n.style.width=a.width||"100%",n.style.height=a.height||"100%",n.style.overflow="hidden",n.allow="cross-origin-isolated"},mr=`var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};function r(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var e={},n={};!function(t){t.__esModule=!0,t.default=["log","debug","info","warn","error","table","clear","time","timeEnd","count","assert","command","result"]}(n);var a,o={},i={};(a=i).__esModule=!0,a.default=function(){var t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+"-"+Date.now()};var u={},s={__esModule:!0};s.update=s.state=void 0,s.update=function(t){s.state=t};var f={},c={};!function(r){var e=t&&t.__assign||function(){return e=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var a in r=arguments[e])Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);return t},e.apply(this,arguments)};r.__esModule=!0,r.initialState=void 0,r.initialState={timings:{},count:{}};var n=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};r.default=function(t,a){var o,i,u;switch(void 0===t&&(t=r.initialState),a.type){case"COUNT":var s=t.count[a.name]||0;return e(e({},t),{count:e(e({},t.count),(o={},o[a.name]=s+1,o))});case"TIME_START":return e(e({},t),{timings:e(e({},t.timings),(i={},i[a.name]={start:n()},i))});case"TIME_END":var f=t.timings[a.name],c=n(),l=c-f.start;return e(e({},t),{timings:e(e({},t.timings),(u={},u[a.name]=e(e({},f),{end:c,time:l}),u))});default:return t}}}(c),function(r){var e=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};r.__esModule=!0;var n=e(c),a=s;r.default=function(t){a.update(n.default(a.state,t))}}(f);var l={__esModule:!0};l.timeEnd=l.timeStart=l.count=void 0,l.count=function(t){return{type:"COUNT",name:t}},l.timeStart=function(t){return{type:"TIME_START",name:t}},l.timeEnd=function(t){return{type:"TIME_END",name:t}};var d=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};u.__esModule=!0,u.stop=u.start=void 0;var p=s,h=d(f),m=l;u.start=function(t){h.default(m.timeStart(t))},u.stop=function(t){var r=null===p.state||void 0===p.state?void 0:p.state.timings[t];return r&&!r.end?(h.default(m.timeEnd(t)),{method:"log",data:[t+": "+p.state.timings[t].time+"ms"]}):{method:"warn",data:["Timer '"+t+"' does not exist"]}};var y={},v=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};y.__esModule=!0,y.increment=void 0;var _=s,b=v(f),g=l;y.increment=function(t){return b.default(g.count(t)),{method:"log",data:[t+": "+_.state.count[t]]}};var M={},T=t&&t.__spreadArrays||function(){for(var t=0,r=0,e=arguments.length;r<e;r++)t+=arguments[r].length;var n=Array(t),a=0;for(r=0;r<e;r++)for(var o=arguments[r],i=0,u=o.length;i<u;i++,a++)n[a]=o[i];return n};M.__esModule=!0,M.test=void 0,M.test=function(t){for(var r=[],e=1;e<arguments.length;e++)r[e-1]=arguments[e];return!t&&(0===r.length&&r.push("console.assert"),{method:"error",data:T(["Assertion failed:"],r)})},function(r){var e=t&&t.__assign||function(){return e=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var a in r=arguments[e])Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);return t},e.apply(this,arguments)},n=t&&t.__createBinding||(Object.create?function(t,r,e,n){void 0===n&&(n=e),Object.defineProperty(t,n,{enumerable:!0,get:function(){return r[e]}})}:function(t,r,e,n){void 0===n&&(n=e),t[n]=r[e]}),a=t&&t.__setModuleDefault||(Object.create?function(t,r){Object.defineProperty(t,"default",{enumerable:!0,value:r})}:function(t,r){t.default=r}),o=t&&t.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var e in t)"default"!==e&&Object.prototype.hasOwnProperty.call(t,e)&&n(r,t,e);return a(r,t),r},s=t&&t.__spreadArrays||function(){for(var t=0,r=0,e=arguments.length;r<e;r++)t+=arguments[r].length;var n=Array(t),a=0;for(r=0;r<e;r++)for(var o=arguments[r],i=0,u=o.length;i<u;i++,a++)n[a]=o[i];return n},f=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};r.__esModule=!0;var c=f(i),l=o(u),d=o(y),p=o(M);r.default=function(t,r,n){var a=n||c.default();switch(t){case"clear":return{method:t,id:a};case"count":return!!(o="string"==typeof r[0]?r[0]:"default")&&e(e({},d.increment(o)),{id:a});case"time":case"timeEnd":var o;return!!(o="string"==typeof r[0]?r[0]:"default")&&("time"===t?(l.start(o),!1):e(e({},l.stop(o)),{id:a}));case"assert":if(0!==r.length){var i=p.test.apply(p,s([r[0]],r.slice(1)));if(i)return e(e({},i),{id:a})}return!1;case"error":return{method:t,id:a,data:r.map((function(t){try{return t.stack||t}catch(r){return t}}))};default:return{method:t,id:a,data:r}}}}(o);var S={},O={};!function(t){var r;t.__esModule=!0,function(t){t[t.infinity=0]="infinity",t[t.minusInfinity=1]="minusInfinity",t[t.minusZero=2]="minusZero"}(r||(r={})),t.default={type:"Arithmetic",lookup:Number,shouldTransform:function(t,r){return"number"===t&&(r===1/0||r===-1/0||function(t){return 1/t==-1/0}(r))},toSerializable:function(t){return t===1/0?r.infinity:t===-1/0?r.minusInfinity:r.minusZero},fromSerializable:function(t){return t===r.infinity?1/0:t===r.minusInfinity?-1/0:t===r.minusZero?-0:t}}}(O);var w={};!function(t){t.__esModule=!0,t.default={type:"Function",lookup:Function,shouldTransform:function(t,r){return"function"==typeof r},toSerializable:function(t){var r="";try{r=t.toString().substring(r.indexOf("{")+1,r.lastIndexOf("}"))}catch(t){}return{name:t.name,body:r,proto:Object.getPrototypeOf(t).constructor.name}},fromSerializable:function(t){try{var r=function(){};return"string"==typeof t.name&&Object.defineProperty(r,"name",{value:t.name,writable:!1}),"string"==typeof t.body&&Object.defineProperty(r,"body",{value:t.body,writable:!1}),"string"==typeof t.proto&&(r.constructor={name:t.proto}),r}catch(r){return t}}}}(w);var A={};!function(t){var r;function e(t){for(var r={},e=0,n=t.attributes;e<n.length;e++){var a=n[e];r[a.name]=a.value}return r}t.__esModule=!0,t.default={type:"HTMLElement",shouldTransform:function(t,r){return r&&r.children&&"string"==typeof r.innerHTML&&"string"==typeof r.tagName},toSerializable:function(t){return{tagName:t.tagName.toLowerCase(),attributes:e(t),innerHTML:t.innerHTML}},fromSerializable:function(t){try{var e=(r||(r=document.implementation.createHTMLDocument("sandbox"))).createElement(t.tagName);e.innerHTML=t.innerHTML;for(var n=0,a=Object.keys(t.attributes);n<a.length;n++){var o=a[n];try{e.setAttribute(o,t.attributes[o])}catch(t){}}return e}catch(r){return t}}}}(A);var j={};!function(r){var e=t&&t.__assign||function(){return e=Object.assign||function(t){for(var r,e=1,n=arguments.length;e<n;e++)for(var a in r=arguments[e])Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a]);return t},e.apply(this,arguments)};r.__esModule=!0,r.default={type:"Map",shouldTransform:function(t,r){return r&&r.constructor&&"Map"===r.constructor.name},toSerializable:function(t){var r={};return t.forEach((function(t,e){var n="object"==typeof e?JSON.stringify(e):e;r[n]=t})),{name:"Map",body:r,proto:Object.getPrototypeOf(t).constructor.name}},fromSerializable:function(t){var r=t.body,n=e({},r);return"string"==typeof t.proto&&(n.constructor={name:t.proto}),n}}}(j);var z={};!function(t){t.__esModule=!0;var r="@t",e=/^#*@(t|r)$/,n=(0,eval)("this"),a="function"==typeof ArrayBuffer,o="function"==typeof Map,i="function"==typeof Set,u=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"],s=Array.prototype.slice,f={serialize:function(t){return JSON.stringify(t)},deserialize:function(t){return JSON.parse(t)}},c=function(){function t(t,r){this.references=t,this.transforms=r,this.transformsMap=this._makeTransformsMap(),this.circularCandidates=[],this.circularCandidatesDescrs=[],this.circularRefCount=0}return t._createRefMark=function(t){var r=Object.create(null);return r["@r"]=t,r},t.prototype._createCircularCandidate=function(t,r,e){this.circularCandidates.push(t),this.circularCandidatesDescrs.push({parent:r,key:e,refIdx:-1})},t.prototype._applyTransform=function(t,e,n,a){var o=Object.create(null),i=a.toSerializable(t);return"object"==typeof i&&this._createCircularCandidate(t,e,n),o[r]=a.type,o.data=this._handleValue((function(){return i}),e,n),o},t.prototype._handleArray=function(t){for(var r=[],e=function(e){r[e]=n._handleValue((function(){return t[e]}),r,e)},n=this,a=0;a<t.length;a++)e(a);return r},t.prototype._handlePlainObject=function(t){var r,n,a=Object.create(null),o=function(r){if(Reflect.has(t,r)){var n=e.test(r)?"#"+r:r;a[n]=i._handleValue((function(){return t[r]}),a,n)}},i=this;for(var u in t)o(u);var s=null===(n=null===(r=null==t?void 0:t.__proto__)||void 0===r?void 0:r.constructor)||void 0===n?void 0:n.name;return s&&"Object"!==s&&(a.constructor={name:s}),a},t.prototype._handleObject=function(t,r,e){return this._createCircularCandidate(t,r,e),Array.isArray(t)?this._handleArray(t):this._handlePlainObject(t)},t.prototype._ensureCircularReference=function(r){var e=this.circularCandidates.indexOf(r);if(e>-1){var n=this.circularCandidatesDescrs[e];return-1===n.refIdx&&(n.refIdx=n.parent?++this.circularRefCount:0),t._createRefMark(n.refIdx)}return null},t.prototype._handleValue=function(t,r,e){try{var n=t(),a=typeof n,o="object"===a&&null!==n;if(o){var i=this._ensureCircularReference(n);if(i)return i}var u=this._findTransform(a,n);return u?this._applyTransform(n,r,e,u):o?this._handleObject(n,r,e):n}catch(t){try{return this._handleValue((function(){return t instanceof Error?t:new Error(t)}),r,e)}catch(t){return null}}},t.prototype._makeTransformsMap=function(){if(o){var t=new Map;return this.transforms.forEach((function(r){r.lookup&&t.set(r.lookup,r)})),t}},t.prototype._findTransform=function(t,r){if(o&&r&&r.constructor&&(null==(a=this.transformsMap.get(r.constructor))?void 0:a.shouldTransform(t,r)))return a;for(var e=0,n=this.transforms;e<n.length;e++){var a;if((a=n[e]).shouldTransform(t,r))return a}},t.prototype.transform=function(){for(var r=this,e=[this._handleValue((function(){return r.references}),null,null)],n=0,a=this.circularCandidatesDescrs;n<a.length;n++){var o=a[n];o.refIdx>0&&(e[o.refIdx]=o.parent[o.key],o.parent[o.key]=t._createRefMark(o.refIdx))}return e},t}(),l=function(){function t(t,r){this.activeTransformsStack=[],this.visitedRefs=Object.create(null),this.references=t,this.transformMap=r}return t.prototype._handlePlainObject=function(t){var r=Object.create(null);for(var n in"constructor"in t&&(t.constructor&&"string"==typeof t.constructor.name||(t.constructor={name:"Object"})),t)t.hasOwnProperty(n)&&(this._handleValue(t[n],t,n),e.test(n)&&(r[n.substring(1)]=t[n],delete t[n]));for(var a in r)t[a]=r[a]},t.prototype._handleTransformedObject=function(t,e,n){var a=t[r],o=this.transformMap[a];if(!o)throw new Error("Can't find transform for \\""+a+'" type.');this.activeTransformsStack.push(t),this._handleValue(t.data,t,"data"),this.activeTransformsStack.pop(),e[n]=o.fromSerializable(t.data)},t.prototype._handleCircularSelfRefDuringTransform=function(t,r,e){var n=this.references;Object.defineProperty(r,e,{val:void 0,configurable:!0,enumerable:!0,get:function(){return void 0===this.val&&(this.val=n[t]),this.val},set:function(t){this.val=t}})},t.prototype._handleCircularRef=function(t,r,e){this.activeTransformsStack.includes(this.references[t])?this._handleCircularSelfRefDuringTransform(t,r,e):(this.visitedRefs[t]||(this.visitedRefs[t]=!0,this._handleValue(this.references[t],this.references,t)),r[e]=this.references[t])},t.prototype._handleValue=function(t,e,n){if("object"==typeof t&&null!==t){var a=t["@r"];if(void 0!==a)this._handleCircularRef(a,e,n);else if(t[r])this._handleTransformedObject(t,e,n);else if(Array.isArray(t))for(var o=0;o<t.length;o++)this._handleValue(t[o],t,o);else this._handlePlainObject(t)}},t.prototype.transform=function(){return this.visitedRefs[0]=!0,this._handleValue(this.references[0],this.references,0),this.references[0]},t}(),d=[{type:"[[NaN]]",shouldTransform:function(t,r){return"number"===t&&isNaN(r)},toSerializable:function(){return""},fromSerializable:function(){return NaN}},{type:"[[undefined]]",shouldTransform:function(t){return"undefined"===t},toSerializable:function(){return""},fromSerializable:function(){}},{type:"[[Date]]",lookup:Date,shouldTransform:function(t,r){return r instanceof Date},toSerializable:function(t){return t.getTime()},fromSerializable:function(t){var r=new Date;return r.setTime(t),r}},{type:"[[RegExp]]",lookup:RegExp,shouldTransform:function(t,r){return r instanceof RegExp},toSerializable:function(t){var r={src:t.source,flags:""};return t.globalThis&&(r.flags+="g"),t.ignoreCase&&(r.flags+="i"),t.multiline&&(r.flags+="m"),r},fromSerializable:function(t){return new RegExp(t.src,t.flags)}},{type:"[[Error]]",lookup:Error,shouldTransform:function(t,r){return r instanceof Error},toSerializable:function(t){var r,e;return t.stack||null===(e=(r=Error).captureStackTrace)||void 0===e||e.call(r,t),{name:t.name,message:t.message,stack:t.stack}},fromSerializable:function(t){var r=new(n[t.name]||Error)(t.message);return r.stack=t.stack,r}},{type:"[[ArrayBuffer]]",lookup:a&&ArrayBuffer,shouldTransform:function(t,r){return a&&r instanceof ArrayBuffer},toSerializable:function(t){var r=new Int8Array(t);return s.call(r)},fromSerializable:function(t){if(a){var r=new ArrayBuffer(t.length);return new Int8Array(r).set(t),r}return t}},{type:"[[TypedArray]]",shouldTransform:function(t,r){if(a)return ArrayBuffer.isView(r)&&!(r instanceof DataView);for(var e=0,o=u;e<o.length;e++){var i=o[e];if("function"==typeof n[i]&&r instanceof n[i])return!0}return!1},toSerializable:function(t){return{ctorName:t.constructor.name,arr:s.call(t)}},fromSerializable:function(t){return"function"==typeof n[t.ctorName]?new n[t.ctorName](t.arr):t.arr}},{type:"[[Map]]",lookup:o&&Map,shouldTransform:function(t,r){return o&&r instanceof Map},toSerializable:function(t){var r=[];return t.forEach((function(t,e){r.push(e),r.push(t)})),r},fromSerializable:function(t){if(o){for(var r=new Map,e=0;e<t.length;e+=2)r.set(t[e],t[e+1]);return r}for(var n=[],a=0;a<t.length;a+=2)n.push([t[e],t[e+1]]);return n}},{type:"[[Set]]",lookup:i&&Set,shouldTransform:function(t,r){return i&&r instanceof Set},toSerializable:function(t){var r=[];return t.forEach((function(t){r.push(t)})),r},fromSerializable:function(t){if(i){for(var r=new Set,e=0;e<t.length;e++)r.add(t[e]);return r}return t}}],p=function(){function t(t){this.transforms=[],this.transformsMap=Object.create(null),this.serializer=t||f,this.addTransforms(d)}return t.prototype.addTransforms=function(t){for(var r=0,e=t=Array.isArray(t)?t:[t];r<e.length;r++){var n=e[r];if(this.transformsMap[n.type])throw new Error('Transform with type "'+n.type+'" was already added.');this.transforms.push(n),this.transformsMap[n.type]=n}return this},t.prototype.removeTransforms=function(t){for(var r=0,e=t=Array.isArray(t)?t:[t];r<e.length;r++){var n=e[r],a=this.transforms.indexOf(n);a>-1&&this.transforms.splice(a,1),delete this.transformsMap[n.type]}return this},t.prototype.encode=function(t){var r=new c(t,this.transforms).transform();return this.serializer.serialize(r)},t.prototype.decode=function(t){var r=this.serializer.deserialize(t);return new l(r,this.transformsMap).transform()},t}();t.default=p}(z);var E=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};S.__esModule=!0,S.Decode=P=S.Encode=void 0;var k=E(O),C=E(w),D=E(A),N=E(j),R=E(z),I=[D.default,C.default,k.default,N.default],x=new R.default;x.addTransforms(I);var P=S.Encode=function(t){return JSON.parse(x.encode(t))};S.Decode=function(t){return x.decode(JSON.stringify(t))},function(r){var e=t&&t.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};r.__esModule=!0;var a=e(n),i=e(o),u=S;r.default=function(t,r,e){void 0===e&&(e=!0);for(var n=t,o={pointers:{},src:{npm:"https://npmjs.com/package/console-feed",github:"https://github.com/samdenty99/console-feed"}},s=function(t){var a=n[t];n[t]=function(){a.apply(this,arguments);var n=[].slice.call(arguments);setTimeout((function(){var a=i.default(t,n);if(a){var o=a;e&&(o=u.Encode(a)),r(o,a)}}))},o.pointers[t]=a},f=0,c=a.default;f<c.length;f++)s(c[f]);return n.feed=o,n}}(e),r(e)(window.console,(function(t){var r=P(t);parent.postMessage({type:"console",codesandbox:!0,log:Array.isArray(r)?r[0]:r},"*")}));
`;function yr(){var n=window.history.__proto__,a=[],o=0,u=function(h){parent.postMessage({type:"urlchange",url:h,back:o>0,forward:o<a.length-1},"*")};function f(h,s){a.splice(o+1),a.push({url:h,state:s}),o=a.length-1}Object.assign(window.history,{go:function(h){var s=o+h;if(s>=0&&s<=a.length-1){o=s;var m=a[o],w=m.url,g=m.state;n.replaceState.call(window.history,g,"",w);var y=document.location.href;u(y),window.dispatchEvent(new PopStateEvent("popstate",{state:g}))}},back:function(){window.history.go(-1)},forward:function(){window.history.go(1)},pushState:function(h,s,m){n.replaceState.call(window.history,h,s,m),f(m,h),u(document.location.href)},replaceState:function(h,s,m){n.replaceState.call(window.history,h,s,m),a[o]={state:h,url:m},u(document.location.href)}});function l(h){var s=h.data;s.type==="urlback"?history.back():s.type==="urlforward"?history.forward():s.type==="refresh"&&document.location.reload()}window.addEventListener("message",l)}var wr=[{code:yr.toString(),id:"historyListener"},{code:"function consoleHook() {"+mr+`
};`,id:"consoleHook"}],vr=function(n){wr.forEach(function(a){var o,u=a.code,f=a.id,l={uid:f,type:sr,code:"exports.activate = "+u,scope:{}};(o=n.contentWindow)===null||o===void 0||o.postMessage(l,"*")})},br=function(n){ve(a,n);function a(o,u,f){f===void 0&&(f={});var l=n.call(this,o,u,ot(ot({},f),{bundlerURL:f.bundlerURL}))||this;return l._modulesCache=new Map,l.emitter=new hr,l.manageIframes(o),l.createNodebox(),l}return a.prototype.createNodebox=function(){this.emulator=new ar({iframe:this.emulatorIframe,runtimeUrl:this.options.bundlerURL})},a.prototype.compile=function(o){return z(this,void 0,void 0,function(){var u,f;return $(this,function(l){switch(l.label){case 0:return l.trys.push([0,7,,8]),this.dispatch({type:"start",firstLoad:!0}),[4,this.emulator.connect()];case 1:return l.sent(),[4,this.emulator.fs.init(o)];case 2:return l.sent(),[4,this.globalListeners()];case 3:return l.sent(),[4,this.createShellProcessFromTask(o)];case 4:return u=l.sent().id,[4,this.createPreviewURLFromId(u)];case 5:return l.sent(),[4,this.setLocationURLIntoIFrame()];case 6:return l.sent(),this.dispatchDoneMessage(),[3,8];case 7:return f=l.sent(),this.dispatch({type:"action",action:"notification",notificationType:"error",title:$t(f)}),this.dispatch({type:"done",compilatonError:!0}),[3,8];case 8:return[2]}})})},a.prototype.createShellProcessFromTask=function(o){return z(this,void 0,void 0,function(){var u,f,l=this;return $(this,function(h){switch(h.label){case 0:return u=cr(o["/package.json"]),this.emulatorCommand=fr(u),this.emulatorShellProcess=this.emulator.shell.create(),[4,this.emulatorShellProcess.on("exit",function(s){l.dispatch({type:"action",action:"notification",notificationType:"error",title:et("Error: process.exit("+s+") called.")})})];case 1:return h.sent(),[4,this.emulatorShellProcess.on("progress",function(s){var m,w;if(s.state==="command_running"||s.state==="starting_command"){l.dispatch({type:"shell/progress",data:ot(ot({},s),{command:[(m=l.emulatorCommand)===null||m===void 0?void 0:m[0],(w=l.emulatorCommand)===null||w===void 0?void 0:w[1].join(" ")].join(" ")})});return}l.dispatch({type:"shell/progress",data:s})})];case 2:return h.sent(),this.emulatorShellProcess.stdout.on("data",function(s){l.dispatch({type:"stdout",payload:{data:s,type:"out"}})}),this.emulatorShellProcess.stderr.on("data",function(s){l.dispatch({type:"stdout",payload:{data:s,type:"err"}})}),[4,(f=this.emulatorShellProcess).runCommand.apply(f,this.emulatorCommand)];case 3:return[2,h.sent()]}})})},a.prototype.createPreviewURLFromId=function(o){return z(this,void 0,void 0,function(){var u;return $(this,function(f){switch(f.label){case 0:return this.iframePreviewUrl=void 0,[4,this.emulator.preview.getByShellId(o)];case 1:return u=f.sent().url,this.iframePreviewUrl=u,[2]}})})},a.prototype.manageIframes=function(o){var u;if(typeof o=="string"){var f=document.querySelector(o);_t(f,"The element '"+o+"' was not found"),this.iframe=document.createElement("iframe")}else this.iframe=o;pr(this.iframe,this.options),_t(this.iframe.parentNode,"The given iframe does not have a parent."),this.emulatorIframe=document.createElement("iframe"),this.emulatorIframe.classList.add("sp-bridge-frame"),(u=this.iframe.parentNode)===null||u===void 0||u.appendChild(this.emulatorIframe)},a.prototype.setLocationURLIntoIFrame=function(){return z(this,void 0,void 0,function(){return $(this,function(o){switch(o.label){case 0:return this.iframePreviewUrl?[4,dr(this.iframe,this.iframePreviewUrl)]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},a.prototype.dispatchDoneMessage=function(){this.dispatch({type:"done",compilatonError:!1}),this.iframePreviewUrl&&this.dispatch({type:"urlchange",url:this.iframePreviewUrl,back:!1,forward:!1})},a.prototype.globalListeners=function(){return z(this,void 0,void 0,function(){var o=this;return $(this,function(u){switch(u.label){case 0:return window.addEventListener("message",function(f){f.data.type===ur&&vr(o.iframe),f.data.type==="urlchange"&&o.dispatch({type:"urlchange",url:f.data.url,back:f.data.back,forward:f.data.forward}),o.dispatch(f.data)}),[4,this.emulator.fs.watch(["*"],[".next","node_modules","build","dist","vendor",".config",".vuepress"],function(f){return z(o,void 0,void 0,function(){var l,h,s,m,w,g,y;return $(this,function(E){switch(E.label){case 0:return f?(l=f,h="newPath"in l?l.newPath:"path"in l?l.path:"",[4,this.emulator.fs.stat(h)]):[2];case 1:if(s=E.sent().type,s!=="file")return[2,null];E.label=2;case 2:switch(E.trys.push([2,10,,11]),m=l.type,m){case"change":return[3,3];case"create":return[3,3];case"remove":return[3,5];case"rename":return[3,6];case"close":return[3,8]}return[3,9];case 3:return[4,this.emulator.fs.readFile(l.path,"utf8")];case 4:return w=E.sent(),this.dispatch({type:"fs/change",path:l.path,content:w}),this._modulesCache.set(l.path,ct(w)),[3,9];case 5:return this.dispatch({type:"fs/remove",path:l.path}),this._modulesCache.delete(l.path),[3,9];case 6:return this.dispatch({type:"fs/remove",path:l.oldPath}),this._modulesCache.delete(l.oldPath),[4,this.emulator.fs.readFile(l.newPath,"utf8")];case 7:return g=E.sent(),this.dispatch({type:"fs/change",path:l.newPath,content:g}),this._modulesCache.set(l.newPath,ct(g)),[3,9];case 8:return[3,9];case 9:return[3,11];case 10:return y=E.sent(),this.dispatch({type:"action",action:"notification",notificationType:"error",title:$t(y)}),[3,11];case 11:return[2]}})})})];case 1:return u.sent(),[2]}})})},a.prototype.restartShellProcess=function(){var o;return z(this,void 0,void 0,function(){return $(this,function(u){switch(u.label){case 0:return this.emulatorShellProcess&&this.emulatorCommand?(this.dispatch({type:"start",firstLoad:!0}),[4,this.emulatorShellProcess.kill()]):[3,3];case 1:return u.sent(),(o=this.iframe)===null||o===void 0||o.removeAttribute("attr"),this.createNodebox(),[4,this.compile(Object.fromEntries(this._modulesCache))];case 2:u.sent(),u.label=3;case 3:return[2]}})})},a.prototype.updateSandbox=function(o){var u=this,f,l=lr(o.files);if(((f=this.emulatorShellProcess)===null||f===void 0?void 0:f.state)==="running"){Object.entries(l).forEach(function(h){var s=h[0],m=h[1];(!u._modulesCache.get(s)||lt.Buffer.compare(m,u._modulesCache.get(s))!==0)&&u.emulator.fs.writeFile(s,m,{recursive:!0})});return}this.dispatch({codesandbox:!0,modules:l,template:o.template,type:"compile"}),Object.entries(l).forEach(function(h){var s=h[0],m=h[1];u._modulesCache.set(s,ct(m))})},a.prototype.dispatch=function(o){var u,f;return z(this,void 0,void 0,function(){var l;return $(this,function(h){switch(h.label){case 0:switch(l=o.type,l){case"compile":return[3,1];case"refresh":return[3,2];case"urlback":return[3,4];case"urlforward":return[3,4];case"shell/restart":return[3,5];case"shell/openPreview":return[3,6]}return[3,7];case 1:return this.compile(o.modules),[3,8];case 2:return[4,this.setLocationURLIntoIFrame()];case 3:return h.sent(),[3,8];case 4:return(f=(u=this.iframe)===null||u===void 0?void 0:u.contentWindow)===null||f===void 0||f.postMessage(o,"*"),[3,8];case 5:return this.restartShellProcess(),[3,8];case 6:return window.open(this.iframePreviewUrl,"_blank"),[3,8];case 7:this.emitter.dispatch(o),h.label=8;case 8:return[2]}})})},a.prototype.listen=function(o){return this.emitter.listener(o)},a.prototype.destroy=function(){this.emulatorIframe.remove(),this.emitter.cleanup()},a}(_e);export{br as SandpackNode};
